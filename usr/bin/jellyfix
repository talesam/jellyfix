#!/bin/bash
# Wrapper para executar jellyfix

# Detecta o diretório de instalação
# Primeiro verifica o diretório local/desenvolvimento (relativo ao script)
SCRIPT_DIR="$(dirname "$(readlink -f "$0")")"
LOCAL_DIR="$SCRIPT_DIR/../share/jellyfix"

if [[ -e "$LOCAL_DIR/main.py" ]]; then
    # Modo desenvolvimento - usa diretório local
    JELLYFIX_DIR="$LOCAL_DIR"
else
    # Modo instalado - procura nos caminhos do sistema
    for i in /usr/lib/python3.{25..6}/site-packages/jellyfix /usr/share/jellyfix; do
        if [[ -e "$i" ]]; then
            JELLYFIX_DIR="$i"
            break
        fi
    done
fi

# Encontra o Python com os módulos necessários
# Prioriza python3 do PATH; fallback para o Python do sistema
if python3 -c "import rich, requests, questionary" 2>/dev/null; then
    PYTHON3=python3
else
    PYTHON3=/usr/bin/python3
fi

# Executa o main.py
exec "$PYTHON3" "$JELLYFIX_DIR/main.py" "$@"

